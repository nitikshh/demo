<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="icon"
        href="https://png.pngtree.com/png-vector/20230213/ourmid/pngtree-letter-n-logo-png-image_6596754.png"
        type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta2/css/all.min.css">
    <link rel="shortcut icon" href="youtube-logo-png-2061.png" type="image/x-icon">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.0/papaparse.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/remixicon@2.5.0/fonts/remixicon.css" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <title>Play It</title>
</head>

<body>
  <div class="search-cont-main">
    <div class="search-cont" id="search-results">
        <!-- Placeholder for search results -->
        <div class="search-grid">
            <div class="search-item">Search Result 1</div>
            <div class="search-item">Search Result 2</div>
            <div class="search-item">Search Result 3</div>
            <!-- Add more search result items as needed -->
        </div>
    </div>
</div>
  <div class="header">
    <div class="logo-container">
        <i class="ri-menu-line"></i>
        <div class="logo">
            <div class="logo-img">
                <!--<img src="myLoog.jpg" alt="">-->
            </div>
            <h1 id="logo-txt">WATCHit
            </h1>
        </div>
    </div>

    <div class="search-container">
        <form id="search-form">
            <input type="text" class="search-input" id="search-input" placeholder="Search"
                onclick="toggleSearchResults()">
        </form>
        <button class="mic"><i class="ri-mic-fill"></i></button>
    </div>


    <style>
        .search-cont {
            position: fixed;
            top: 70px;
            left: 0;
            overflow: scroll;
            width: 100%;
            /* Full-width container */
            height: 100%;
            /* Full-height container */
            background-color: rgba(15, 12, 12, 0.95);
            /* Semi-transparent white background */
            display: none;
            /* Initially hidden */
            z-index: 9999;
            overflow: auto;
            /* Enable scrolling */
        }

        .search-cont .video-content-cover {
            width: 400px;
        }

        .search-cont .hidden-content {
            display: none;
        }

        .search-cont-main {
            display: flex;
            
            overflow: scroll;
            
            height: 100vh;
            /* Set the height to cover the viewport */

            position: fixed;
            top: 70px;
            left: 0;
            z-index: 9998;
            /* A lower z-index than the search results to keep it behind */
        }

        .search-grid {
            /* Create a grid layout for search results */
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            /* Adjust the number of columns as needed */
            gap: 10px;
            /* Gap between grid items */
            padding: 20px;
        }

        .search-item {
            /* Individual search result item styles */
            padding: 10px;
            border: 1px solid #ccc;
            margin: 10px;
            background-color: #fff;
        }


    </style>
    <script>
        function toggleSearchResults() {
            var searchResults = document.getElementById('search-results');
            if (searchResults.style.display === 'none' || searchResults.style.display === '') {
                searchResults.style.display = 'block';
            } else {
                searchResults.style.display = 'none';
            }
        }
    </script>


    <div class="profile-container">
        <i class="fa-solid fa-triangle-exclamation"></i>
        <i class="ri-grid-fill"></i>
        <i class="ri-play-list-2-line"></i>
        <i class="fa-solid ri-question-line"></i>
        <!--<div class="profile-box">
            <img src="unnamed (7).jpg" alt="">
        </div>
        -->
    </div>
</div>
<div class="body-container">
  <div class="sidebar">
      <div class="sidebar-items">
          <a  class="sidebar-item" href="/"><i class="ri-home-5-line"></i></i>Home</a>
          <a href="/upload" class="sidebar-item"><i class="ri-compass-3-line"></i>Upload</a>
          <a class="sidebar-item"><i class="ri-wireless-charging-line"></i>Shorts</a>
          <a class="sidebar-item"><i class="ri-rss-line"></i>Subscription</a>
          <hr>
          <a class="sidebar-item"><i class="ri-links-line"></i>Library</a>
          <a class="sidebar-item"><i class="ri-history-line"></i>History</a>
          <a class="sidebar-item"><i class="ri-video-line"></i>Your videos</a>
          <a class="sidebar-item"><i class="ri-time-line"></i>Watch later</a>
          <a class="sidebar-item"><i class="ri-play-list-2-line"></i>All videos</a>
          <a class="sidebar-item"><i class="ri-arrow-down-s-line"></i>Show more</a>
          <hr>
          <h4 class="more">More from youtube</h4>
          <a class="sidebar-item"><i class="ri-keyboard-box-line"></i>Gaming</a>
          <a class="sidebar-item"><i class="ri-live-line"></i>Live</a>
          <a class="sidebar-item"><i class="ri-award-line"></i>Sports</a>
          <hr>
          <a class="sidebar-item"><i class="ri-settings-5-line"></i>Settings</a>
          <a class="sidebar-item"><i class="ri-flag-line"></i>Report history</a>
          <a class="sidebar-item"><i class="ri-question-line"></i>Help</a>
          <a class="sidebar-item"><i class="ri-feedback-line"></i>Send feedback</a>

      </div>

  </div>
  <div class="content">
      <div class="chips-wrapper">
          <div class="chip">
              <p>All</p>
          </div>
          <div class="chip">
              <p>CSS</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
          <div class="chip">
              <p>User interface design</p>
          </div>
      </div>
      <div  class="video-container" id="video-container"></div>
  </div>
</div>
</div>

  <script>
    // Function to create and append video elements
    function createVideoElement(rowData) {
      var videoContentCover = document.createElement('div');
      videoContentCover.className = 'video-content-cover';

      var videoContent = document.createElement('div');
      videoContent.className = 'video-content';
      videoContent.id = 'template-container';

      // Modify the videoBox href to include query parameters
      var videoBox = document.createElement('a');
      videoBox.href = 'play.html?video=' + rowData.videoUrl + '&title=' + encodeURIComponent(rowData.title);
      videoBox.className = 'video-box';

      var img = document.createElement('img');
      img.src = rowData.posterUrl;
      img.alt = '';

      videoBox.appendChild(img);
      videoContent.appendChild(videoBox);
      videoContentCover.appendChild(videoContent);

      var videoDetails = document.createElement('div');
      videoDetails.className = 'video-details';

      var detail = document.createElement('div');
      detail.className = 'detail';

      var h3 = document.createElement('h3');
      h3.className = 'title';
      h3.textContent = rowData.title;

      detail.appendChild(h3);

      videoDetails.appendChild(detail);

      videoContentCover.appendChild(videoDetails);

      return videoContentCover;
    }

    // Load video data from the server
    fetch('/video-list')
      .then(response => response.json())
      .then(data => {
        console.log(data); // Log the received data to the console
        const container = document.getElementById('video-container');

        data.forEach(rowData => {
          const videoElement = createVideoElement(rowData);
          container.appendChild(videoElement);
        });
      })
      .catch(error => {
        console.log(error); // Log the actual error message or error object
      });


  </script>
  <script>
    const container = document.querySelector(".container"),
      mainVideo = container.querySelector("video"),
      videoTimeline = container.querySelector(".video-timeline"),
      progressBar = container.querySelector(".progress-bar"),
      volumeBtn = container.querySelector(".volume i"),
      volumeSlider = container.querySelector(".left input");
    currentVidTime = container.querySelector(".current-time"),
      videoDuration = container.querySelector(".video-duration"),
      skipBackward = container.querySelector(".skip-backward i"),
      skipForward = container.querySelector(".skip-forward i"),
      playPauseBtn = container.querySelector(".play-pause i"),
      speedBtn = container.querySelector(".playback-speed span"),
      speedOptions = container.querySelector(".speed-options"),
      pipBtn = container.querySelector(".pic-in-pic span"),
      fullScreenBtn = container.querySelector(".fullscreen i");
    let timer;

    const hideControls = () => {
      if (mainVideo.paused) return;
      timer = setTimeout(() => {
        container.classList.remove("show-controls");
      }, 3000);
    }
    hideControls();

    container.addEventListener("mousemove", () => {
      container.classList.add("show-controls");
      clearTimeout(timer);
      hideControls();
    });

    const formatTime = time => {
      let seconds = Math.floor(time % 60),
        minutes = Math.floor(time / 60) % 60,
        hours = Math.floor(time / 3600);

      seconds = seconds < 10 ? `0${seconds}` : seconds;
      minutes = minutes < 10 ? `0${minutes}` : minutes;
      hours = hours < 10 ? `0${hours}` : hours;

      if (hours == 0) {
        return `${minutes}:${seconds}`
      }
      return `${hours}:${minutes}:${seconds}`;
    }

    videoTimeline.addEventListener("mousemove", e => {
      let timelineWidth = videoTimeline.clientWidth;
      let offsetX = e.offsetX;
      let percent = Math.floor((offsetX / timelineWidth) * mainVideo.duration);
      const progressTime = videoTimeline.querySelector("span");
      offsetX = offsetX < 20 ? 20 : (offsetX > timelineWidth - 20) ? timelineWidth - 20 : offsetX;
      progressTime.style.left = `${offsetX}px`;
      progressTime.innerText = formatTime(percent);
    });

    videoTimeline.addEventListener("click", e => {
      let timelineWidth = videoTimeline.clientWidth;
      mainVideo.currentTime = (e.offsetX / timelineWidth) * mainVideo.duration;
    });

    mainVideo.addEventListener("timeupdate", e => {
      let { currentTime, duration } = e.target;
      let percent = (currentTime / duration) * 100;
      progressBar.style.width = `${percent}%`;
      currentVidTime.innerText = formatTime(currentTime);
    });

    mainVideo.addEventListener("loadeddata", () => {
      videoDuration.innerText = formatTime(mainVideo.duration);
    });

    const draggableProgressBar = e => {
      let timelineWidth = videoTimeline.clientWidth;
      progressBar.style.width = `${e.offsetX}px`;
      mainVideo.currentTime = (e.offsetX / timelineWidth) * mainVideo.duration;
      currentVidTime.innerText = formatTime(mainVideo.currentTime);
    }

    volumeBtn.addEventListener("click", () => {
      if (!volumeBtn.classList.contains("fa-volume-high")) {
        mainVideo.volume = 0.5;
        volumeBtn.classList.replace("fa-volume-xmark", "fa-volume-high");
      } else {
        mainVideo.volume = 0.0;
        volumeBtn.classList.replace("fa-volume-high", "fa-volume-xmark");
      }
      volumeSlider.value = mainVideo.volume;
    });

    volumeSlider.addEventListener("input", e => {
      mainVideo.volume = e.target.value;
      if (e.target.value == 0) {
        return volumeBtn.classList.replace("fa-volume-high", "fa-volume-xmark");
      }
      volumeBtn.classList.replace("fa-volume-xmark", "fa-volume-high");
    });

    speedOptions.querySelectorAll("li").forEach(option => {
      option.addEventListener("click", () => {
        mainVideo.playbackRate = option.dataset.speed;
        speedOptions.querySelector(".active").classList.remove("active");
        option.classList.add("active");
      });
    });

    document.addEventListener("click", e => {
      if (e.target.tagName !== "SPAN" || e.target.className !== "material-symbols-rounded") {
        speedOptions.classList.remove("show");
      }
    });

    fullScreenBtn.addEventListener("click", () => {
      container.classList.toggle("fullscreen");
      if (document.fullscreenElement) {
        fullScreenBtn.classList.replace("fa-compress", "fa-expand");
        return document.exitFullscreen();
      }
      fullScreenBtn.classList.replace("fa-expand", "fa-compress");
      container.requestFullscreen();
    });

    speedBtn.addEventListener("click", () => speedOptions.classList.toggle("show"));
    pipBtn.addEventListener("click", () => mainVideo.requestPictureInPicture());
    skipBackward.addEventListener("click", () => mainVideo.currentTime -= 5);
    skipForward.addEventListener("click", () => mainVideo.currentTime += 5);
    mainVideo.addEventListener("play", () => playPauseBtn.classList.replace("fa-play", "fa-pause"));
    mainVideo.addEventListener("pause", () => playPauseBtn.classList.replace("fa-pause", "fa-play"));
    playPauseBtn.addEventListener("click", () => mainVideo.paused ? mainVideo.play() : mainVideo.pause());
    videoTimeline.addEventListener("mousedown", () => videoTimeline.addEventListener("mousemove", draggableProgressBar));
    document.addEventListener("mouseup", () => videoTimeline.removeEventListener("mousemove", draggableProgressBar));
  </script>
  <script src="https://kit.fontawesome.com/your-font-awesome-kit.js"></script>
</body>

</html>
